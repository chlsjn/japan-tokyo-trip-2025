<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ—¥æœ¬æ±äº¬è¼•äº•æ¾¤ä¸ƒæ—¥æ—…ç¨‹</title>
    <!-- å¼•å…¥ Tailwind CSS ç¢ºä¿éŸ¿æ‡‰å¼è¨­è¨ˆå’Œç°¡æ½”é¢¨æ ¼ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ Lucide Icons for aesthetic icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- iOS ä¸»ç•«é¢åœ–ç¤º -->
    <link rel="apple-touch-icon" href="japan01.png">
    <!-- é–‹å•Ÿ Web App æ¨¡å¼ (éš±è—ç€è¦½å™¨ä»‹é¢) -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="æ±äº¬ä¹‹æ—…">
    
    <style>
        /* ğŸ¨ æŸ”å’Œä¸»é¡Œé¡è‰² */
        :root {
            --color-primary: #1F2937; /* æ·±ç°/ä¸»è¦æ–‡å­— */
            --color-accent: #3B82F6; /* è—è‰²/å¼·èª¿è‰² */
            --color-bg-light: #F7F8FC; /* æ¥µæ·ºèƒŒæ™¯ */
            --color-bg-card: #FFFFFF; /* å¡ç‰‡èƒŒæ™¯ */
            --color-border: #E5E7EB;
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--color-bg-light); /* ç¶²é èƒŒæ™¯ */
            padding-bottom: 70px; 
            color: var(--color-primary); /* ç¬¬å¹¾å¤©å°èˆªæŒ‰éˆ•çš„æ–‡å­—é¡è‰²(æœªé¸æ“‡æ™‚) */
        }

        /* éš±è—æ©«å‘æ²è»¸ä½†ä¿ç•™æ»‘å‹•åŠŸèƒ½ */
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        /* è‡ªå®šç¾© Tailwind é…ç½® */
        .card-shadow {
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08), 0 1px 4px rgba(0, 0, 0, 0.05);
        }
        
        /* åº•éƒ¨å°èˆªåˆ—æ¨£å¼ */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60px;
            background-color: var(--color-bg-card);
            border-top: 1px solid var(--color-border);
            z-index: 1000;
            padding-bottom: env(safe-area-inset-bottom);
        }

        /* è¡Œç¨‹é¡å‹æ¨™ç±¤æ¨£å¼ - ä¿æŒç°¡æ½” */
        .tag-base {
            padding: 2px 8px;
            border-radius: 9999px;
            font-size: 0.7rem;
            font-weight: 500;
            line-height: 1;
            white-space: nowrap;
        }
        .tag-sight { background-color: #ECFDF5; color: #059669; } /* Green */
        .tag-gourmet { background-color: #FFFBEB; color: #D97706; } /* Yellow */
        .tag-transport { background-color: #EFF6FF; color: #2563EB; } /* Blue */
        .tag-accommodation { background-color: #F3F4F6; color: #4B5563; } /* Gray */
        .tag-alert { background-color: #FEF2F2; color: #EF4444; } /* Red */

        /* ====== è¡Œç¨‹æ™‚é–“è»¸æ¨£å¼ (ä»¿ App Timeline) ====== */
        .timeline-container {
            position: relative;
            padding-left: 20px;
            margin-left: 12px; /* ç‚ºäº†è®“é»é»æœ‰ç©ºé–“é¡¯ç¤º */
        }
        .timeline-container::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: #F3F4F6; /* æ¥µæ·ºç°ç·šæ¢ */
        }
        .timeline-item {
            position: relative;
            padding-bottom: 32px; /* é …ç›®é–“è· */
            padding-left: 20px;
        }
        .timeline-dot {
            position: absolute;
            left: -24px; /* å‚ç›´ç·šæ¢å·¦å´ */
            top: 0; 
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: var(--color-primary); /* é»é»é¡è‰² */
            border: 2px solid var(--color-bg-light); /* æ·ºè‰²èƒŒæ™¯ç’°ï¼Œè®“é»æ›´çªå‡º */
            z-index: 10;
        }
        .timeline-alert .timeline-dot {
             background-color: #EF4444; /* è­¦ç¤ºç´…é» */
        }
        .timeline-item:last-child {
            padding-bottom: 8px; /* æœ€å¾Œä¸€é …æ¸›å°‘é–“è· */
        }
    </style>
</head>
<body>

<!-- Main App Container -->
<div id="app" class="max-w-xl mx-auto min-h-screen">
    
    <!-- Header -->
    <header class="p-6 bg-white border-b border-gray-100 sticky top-0 z-50 card-shadow">
        <h1 class="text-xl font-bold text-gray-800">æ—¥æœ¬æ±äº¬è¼•äº•æ¾¤ä¸ƒæ—¥æ—…ç¨‹</h1>
        <p class="text-sm text-gray-500 mt-1">åŸå¸‚èˆ‡é›ªåœ‹çš„äº¤éŸ¿æ›² | 2025/12/3 - 12/9</p>
    </header>

    <!-- Content Area (Itinerary or Tools) -->
    <main class="p-4 sm:p-6 pb-20">
        <!-- Itinerary Tab -->
        <div id="tab-itinerary" class="tab-content active">
            <!-- Day Navigation Pills (ç°¡æ½”è¨­è¨ˆ) -->
            <div id="day-nav-pills" class="flex overflow-x-auto whitespace-nowrap py-3 space-x-3 sticky top-[85px] bg-f7f8fc z-40 bg-gray-50 rounded-xl p-2 card-shadow mb-4">
                <!-- Buttons will be dynamically generated here -->
            </div>

            <!-- Daily Itinerary Cards -->
            <div id="itinerary-list">
                <!-- Daily content will be rendered here -->
            </div>
        </div>

        <!-- Tools Tab -->
        <div id="tab-tools" class="tab-content hidden">
            <h2 class="text-2xl font-bold mb-6 border-l-4 border-gray-300 pl-3 text-gray-700">å…¶ä»–æ—…éŠå·¥å…·</h2>
            
            <!-- MUST HAVE Card (é‡è¦è³‡æº) -->
            <div class="bg-gray-800 text-white p-5 rounded-xl mb-6 card-shadow border-b-4 border-red-500">
                <h3 class="text-lg font-bold mb-2 flex items-center">
                    <i data-lucide="alert-triangle" class="w-5 h-5 mr-2 text-red-400"></i>
                    MUST HAVE / é‡è¦è³‡æº
                </h3>
                <div class="border-t border-gray-700 pt-3">
                    <p class="text-sm font-medium">Visit Japan Web</p>
                    <p class="text-xs text-gray-400 mt-1">å…¥å¢ƒå¯©æŸ¥ & æµ·é—œç”³å ± (è«‹æˆªåœ– QR Code)</p>
                    <a href="https://www.vjw.digital.go.jp/" target="_blank" class="mt-2 inline-flex items-center text-blue-300 hover:text-blue-200 text-sm">
                        <i data-lucide="external-link" class="w-4 h-4 mr-1"></i> å‰å¾€ VJW
                    </a>
                </div>
            </div>

            <!-- Emergency Card (ç·Šæ€¥è¯çµ¡) -->
            <div class="bg-white p-5 rounded-xl mb-6 card-shadow">
                <div class="flex items-center text-lg font-bold mb-3 border-b pb-2 text-red-600">
                    <i data-lucide="phone-call" class="w-5 h-5 mr-2"></i>
                    ç·Šæ€¥è¯çµ¡ & æ”¯æ´
                </div>
                <div id="emergency-info" class="text-sm space-y-3">
                    <!-- Data will be loaded here -->
                </div>
            </div>
            
            <!-- Flight Info Card -->
            <div class="bg-white p-5 rounded-xl mb-6 card-shadow">
                <div class="flex items-center text-lg font-bold mb-3 border-b pb-2 text-blue-500">
                    <i data-lucide="plane" class="w-5 h-5 mr-2 text-blue-500"></i>
                    èˆªç­è³‡è¨Š (Flight)
                </div>
                <div id="flight-info" class="text-sm space-y-2">
                    <!-- Data will be loaded here -->
                </div>
            </div>

            <!-- Accommodation Card -->
            <div class="bg-white p-5 rounded-xl mb-6 card-shadow">
                <div class="flex items-center text-lg font-bold mb-3 border-b pb-2 text-green-500">
                    <i data-lucide="building" class="w-5 h-5 mr-2 text-green-500"></i>
                    ä½å®¿è³‡è¨Š (Hotel)
                </div>
                <div id="hotel-info" class="text-sm space-y-2">
                    <!-- Data will be loaded here -->
                </div>
            </div>

            <!-- è¨˜å¸³/é ç®—è¡¨å¡ç‰‡å·²ç§»é™¤ -->
        </div>
    </main>

    <!-- Bottom Navigation (Fixed) -->
    <nav class="bottom-nav flex justify-around items-center">
        <button class="nav-btn flex flex-col items-center p-2 text-sm text-gray-800 active-nav-btn" data-tab="itinerary">
            <i data-lucide="calendar-days" class="w-6 h-6"></i>
            <span class="text-xs font-semibold">è¡Œç¨‹</span>
        </button>
        <button class="nav-btn flex flex-col items-center p-2 text-sm text-gray-500" data-tab="tools">
            <i data-lucide="tool" class="w-6 h-6"></i>
            <span class="text-xs">å·¥å…·</span>
        </button>
    </nav>
</div>

<script>
    // --- Configuration and Data ---
    
    // è¡Œç¨‹è³‡æ–™ (ç°¡åŒ–èˆ‡èª¿æ•´ï¼Œæ–°å¢ type å’Œ location æ¬„ä½ä»¥åˆ©åœ°åœ–å’Œ AI åˆ†æ)
    const itineraryData = [
        // Day 1: Karuizawa Arrival
        { day: 1, date: '2025/12/3 (Wed)', dayName: 'è¼•äº•æ¾¤åˆè¦‹ ğŸŒ²', location: 'è¼•äº•æ¾¤', time: '14:20', type: 'transport', title: 'æˆç”°ç©ºæ¸¯2èˆªå»ˆ (NRT)', details: 'ğŸ›¬ æŠµé”æ—¥æœ¬', tags: ['transport'] },
        { day: 1, time: '15:42', type: 'transport', title: 'Skyliner å¾€äº¬æˆä¸Šé‡', location: 'äº¬æˆä¸Šé‡', details: 'âš¡ï¸ äº¤é€šé è¨‚æé†’ï¼šæœªè¨‚ç¥¨ (Â¥2,567)', tags: ['transport', 'alert'], link: 'https://www.keisei.co.jp/keisei/tetudou/skyliner/tc/traffic/skyliner.php' }, // æ–°å¢ Skyliner é€£çµ
        { day: 1, time: '16:58', type: 'transport', title: 'JR æ–°å¹¹ç·š Asama å¾€è¼•äº•æ¾¤', location: 'è¼•äº•æ¾¤è»Šç«™', details: 'ğŸš„ é‡å¤§äº¤é€šï¼šç¾å ´è³¼ç¥¨ (Â¥5,280)', tags: ['transport', 'alert'], link: 'https://ekitan.com/transit/shinkansen/section/sf-1627/st-3467/asama?dt=20251203&hour=' },
        { day: 1, time: '18:18', type: 'accommodation', title: 'Hotel Cypress Karuizawa', location: 'Hotel Cypress Karuizawa', details: 'ğŸš¶ æ­¥è¡Œ 12 åˆ†é˜ (å¯æ­ Taxi)', tags: ['accommodation'] },
        { day: 1, time: '19:00', type: 'gourmet', title: 'DELICIA è¼•äº•æ¾¤åº—', location: 'DELICIA è¼•äº•æ¾¤åº—', details: 'ğŸ›’ æœ‰ä¾¿ç•¶å¯å¾®æ³¢å…§ç”¨', tags: ['gourmet'] },

        // Day 2: Winter Karuizawa
        { day: 2, date: '2025/12/4 (Thu)', dayName: 'è¼•äº•æ¾¤å†¬æ—¥ç‰©èª â„ï¸', location: 'è¼•äº•æ¾¤', time: '08:30', type: 'transport', title: 'ç”ºå…§å¾ªç’°å·´å£«å¾€ èˆŠè¼•äº•æ¾¤', location: 'èˆŠè¼•äº•æ¾¤', 
          details: 'ğŸšŒ æ–¼é‡æ²¢åŸï¼ˆãƒã‚¹ï¼‰æ­ä¹˜ï¼Œå·´å£«è²»ï¼šÂ¥100ã€‚', 
          tags: ['transport', 'alert'], link: 'https://japantravel.navitime.com/zh-tw/area/jp/railroad/00069997/' }, 
        { day: 2, time: '08:42', type: 'sight', title: 'èˆŠè¼•äº•æ¾¤éŠ€åº§é€š æ¼«æ­¥', location: 'èˆŠè¼•äº•æ¾¤éŠ€åº§é€š', details: 'äº«å—å†¬æ—¥å¯§éœçš„æ—©æ™¨', tags: ['sight'] },
        { day: 2, time: '12:00', type: 'gourmet', title: 'å·ä¸Šåºµè¼•äº•æ¾¤æœ¬åº—', location: 'å·ä¸Šåºµè¼•äº•æ¾¤æœ¬åº—', details: 'ğŸœ è‘—åçš„æ—¥å¼è•éº¥éºµ', tags: ['gourmet'] },
        { day: 2, time: '13:00', type: 'transport', title: 'è¥¿æ­¦å·´å£«å¾€ æ˜Ÿé‡æº«æ³‰', location: 'æ˜Ÿé‡æº«æ³‰', details: 'ğŸšŒ å·´å£«è²»ï¼šÂ¥420', tags: ['transport'], link: 'https://kimiyo.tw/karuizawa-local-traffic/' },
        { day: 2, time: '13:26', type: 'sight', title: 'ã‚±ãƒ©æ± ã‚¹ã‚±ãƒ¼ãƒˆãƒªãƒ³ã‚¯ (æºœå†°å ´)', location: 'ã‚±ãƒ©æ± ã‚¹ã‚±ãƒ¼ãƒˆãƒªãƒ³ã‚¯', details: 'â›¸ï¸ é–€ç¥¨: Â¥1,900', tags: ['sight'] },
        { day: 2, time: '15:00', type: 'sight', title: 'çŸ³ä¹‹æ•™æœƒ', location: 'çŸ³ä¹‹æ•™æœƒ', details: 'â›ªï¸ ç¨ç‰¹çš„çŸ³ç Œèˆ‡ç»ç’ƒå»ºç¯‰ï¼Œç”±ç¾åœ‹å»ºç¯‰å¸« Kendrick Kellogg è¨­è¨ˆ (é–‹æ”¾è‡³ 17:00)', tags: ['sight'] },
        { day: 2, time: '17:30', type: 'sight', title: 'æ˜Ÿé‡æº«æ³‰ Tonbo-no-yu æ³¡æ¹¯', location: 'æ˜Ÿé‡æº«æ³‰ Tonbo-no-yu', details: 'â™¨ï¸ è²»ç”¨: Â¥1,350', tags: ['sight'] },
        { day: 2, time: '19:00', type: 'gourmet', title: 'æ‘æ°‘é£Ÿå ‚', location: 'æ‘æ°‘é£Ÿå ‚', details: 'å…ˆæŠ½è™Ÿç¢¼ç‰Œ', tags: ['gourmet'] },
        { day: 2, time: '20:00', type: 'sight', title: 'è¼•äº•æ¾¤é«˜åŸæ•™æœƒ è–èª•é»ç‡ˆ', location: 'è¼•äº•æ¾¤é«˜åŸæ•™æœƒ', details: 'âœ¨ å·²ç™»è¨˜ï¼', tags: ['sight', 'alert'] },

        // Day 3: Tokyo Switch
        { day: 3, date: '2025/12/5 (Fri)', dayName: 'è³¼ç‰©èˆ‡éƒ½æœƒåˆ‡æ› ğŸ™ï¸', location: 'æ±äº¬', time: '09:10', type: 'gourmet', title: 'TruffleBAKERY è¼•äº•æ¾¤åº—', location: 'TruffleBAKERY è¼•äº•æ¾¤åº—', details: 'ğŸ¥ æœ¨æ‘æ‹“å“‰æ¨è–¦ã€Œç™½æ¾éœ²é¹½å¥¶æ²¹æ²ã€', tags: ['gourmet'] },
        { day: 3, time: '10:00', type: 'shopping', title: 'è¼•äº•æ¾¤ç‹å­è³¼ç‰©å»£å ´', location: 'è¼•äº•æ¾¤ç‹å­è³¼ç‰©å»£å ´', details: 'ğŸ›ï¸ é€—ç•™æ™‚é–“åŒ…å«åˆé¤', tags: ['shopping'] },
        { day: 3, time: '15:00', type: 'transport', title: 'JR æ–°å¹¹ç·š Asama å¾€æ±äº¬', location: 'æ±äº¬è»Šç«™', details: 'ğŸš„ äº¤é€šè²»ï¼šÂ¥5,280', tags: ['transport'] },
        { day: 3, time: '16:36', type: 'transport', title: 'åœ°éµå¾€ ç”°åŸç”º', location: 'ç”°åŸç”ºç«™', details: 'ğŸš‡ å‡ºå£ 1 (é›»æ¢¯) æ­¥è¡Œ 4 åˆ†é˜', tags: ['transport'] },
        { day: 3, time: '16:40', type: 'accommodation', title: 'å¤‰ãªãƒ›ãƒ†ãƒ«æ±äº¬æµ…è‰ç”°åŸç”º å…¥ä½', location: 'å¤‰ãªãƒ›ãƒ†ãƒ«æ±äº¬æµ…è‰ç”°åŸç”º', details: 'ä¼‘æ¯ 50 åˆ†é˜', tags: ['accommodation'] },
        { day: 3, time: '18:00', type: 'gourmet', title: 'Spice Cafe ã‚¹ãƒ‘ã‚¤ã‚¹ã‚«ãƒ•ã‚§', location: 'Spice Cafe ã‚¹ãƒ‘ã‚¤ã‚¹ã‚«ãƒ•ã‚§', details: 'ğŸ› è¨ˆç¨‹è»Šå‰å¾€', tags: ['gourmet'] },
        { day: 3, time: '20:00', type: 'sight', title: 'å¤œé–“è‡ªç”±æ´»å‹•', location: 'æ±äº¬ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼', details: 'ğŸ—¼ æ™´ç©ºå¡”æˆ–é£¯åº—å‘¨é‚Šæ™ƒæ™ƒ', tags: ['sight'] },

        // Day 4: Edo & Modern Night
        { day: 4, date: '2025/12/6 (Sat)', dayName: 'æ±Ÿæˆ¶é¢¨æƒ…èˆ‡æ‘©ç™»ä¹‹å¤œ ğŸ®', location: 'æ±äº¬', time: '08:30', type: 'gourmet', title: 'é£¯åº—æˆ–æ·ºè‰é™„è¿‘æ—©é¤', location: 'ãƒ‘ãƒ³ã®ãƒšãƒªã‚«ãƒ³/ KIELO COFFEE ASAKUSA', details: 'ğŸ éµœé¶˜éºµåŒ…åº—æœ‰åçš„ç™½åå¸ / KIELO COFFEE ASAKUSA', tags: ['gourmet'] },
        { day: 4, time: '09:00', type: 'sight', title: 'æ·ºè‰é›·é–€ / ä»²è¦‹ä¸–å•†åº—è¡—', location: 'æ·ºè‰é›·é–€', details: 'â›©ï¸ æ±äº¬æœ€å¤è€çš„å¯ºå»Ÿï¼Œæ‹ç…§ç•™å¿µ', tags: ['sight', 'shopping'] },
        { day: 4, time: '10:30', type: 'sight', title: 'åˆç¾½æ©‹é“å…·è¡—', location: 'åˆç¾½æ©‹é“å…·è¡—', details: 'ğŸ›’ æ¢ç´¢å»šæˆ¿ç”¨å“ã€é¤å…·', tags: ['sight', 'shopping'] },
        { day: 4, time: '11:30', type: 'gourmet', title: 'åˆé¤ï¼šæ·ºè‰/åˆç¾½æ©‹å‘¨é‚Šç¾é£Ÿ', location: 'Tonkatsu Juroku / é›·é–€ä¸‰å®š', details: 'ğŸ¤ å¯é¸ç‚¸è±¬æ’/å¤©å©¦ç¾…é›·é–€ä¸‰å®š/å…¶ä»–', tags: ['gourmet'] },
        { day: 4, time: '13:00', type: 'gourmet', title: 'Leaves Coffee Roasters', location: 'Leaves Coffee Roasters', details: 'â˜•ï¸ æ­è¨ˆç¨‹è»Šå‰å¾€ (ç´„ 10 åˆ†é˜)ã€‚äº«å—æ—¥æœ¬å† è»å’–å•¡ã€‚', tags: ['gourmet', 'transport'] },
        { day: 4, time: '14:00', type: 'sight', title: 'æ¸…æ¾„ç™½æ²³æ•£ç­–', location: 'æ·±å·æ±Ÿæˆ¸è³‡æ–™é¤¨ / é’è‘‰å ‚ (Aoba-do)', details: 'ğŸ˜ï¸ åƒè§€æ·±å·æ±Ÿæˆ¸è³‡æ–™é¤¨ / é€›é€›é’è‘‰å ‚', tags: ['sight', 'shopping'] },
        { day: 4, time: '14:00', type: 'gourmet', title: 'æ¸…æ¾„ç™½æ²³å’–å•¡è¡—å€', location: 'Arise Coffee Roasters', details: 'â˜•ï¸ Blue Bottle / Allpress / Arise Coffee', tags: ['gourmet'] },
        { day: 4, time: '17:00', type: 'transport', title: 'ç§»å‹•è‡³æ±äº¬éµå¡”', location: 'æ±äº¬ã‚¿ãƒ¯ãƒ¼', details: 'ğŸš‡ æ­ä¹˜åœ°éµ (åŠè—é–€ç·šè½‰å¤§æ±Ÿæˆ¶ç·šè‡³èµ¤ç¾½æ©‹æˆ–å¤§é–€ç«™)', tags: ['transport'] },
        { day: 4, time: '19:00', type: 'gourmet', title: 'æ™šé¤ï¼šæ±äº¬éµå¡”å‘¨é‚Š', location: '4 Chome Shibakoen', details: 'ğŸ½ï¸ éš¨ä¾¿é¸ä¸€å®¶ (é™„è¿‘æœ‰ä¸€å®¶é ç´„å›°é›£è±†è…æ–™ç†åº—$$$)', tags: ['gourmet'] },
        { day: 4, time: '20:30', type: 'sight', title: 'æ±äº¬ã‚¿ãƒ¯ãƒ¼ (æ±äº¬éµå¡”)', location: 'æ±äº¬ã‚¿ãƒ¯ãƒ¼', details: 'ğŸ—¼ å¯ç¶²è·¯è³¼ç¥¨ (Â¥3,500)', tags: ['sight', 'alert'] },

        // Day 5: Tsukiji & Ginza
        { day: 5, date: '2025/12/7 (Sun)', dayName: 'ç¯‰åœ°èˆ‡éŠ€åº§æ™‚å°šå·¡ç¦® ğŸ£', location: 'æ±äº¬', time: '08:45', type: 'gourmet', title: 'ç¯‰åœ°å ´å¤–å¸‚å ´', location: 'ç¯‰åœ°å ´å¤–å¸‚å ´', details: 'ğŸŸ æµ·é®®ç‡’ / ç‰å­ç‡’ / æˆ–ç¡åˆ°è‡ªç„¶é†’', tags: ['gourmet'] },
        { day: 5, time: '10:00', type: 'gourmet', title: 'Glitch Coffee (éŠ€åº§)', location: 'GLITCH COFFEE GINZA', details: 'â˜•ï¸ é–‹å§‹éŠ€åº§è¡Œç¨‹', tags: ['gourmet'] },
        { day: 5, time: '11:00', type: 'gourmet', title: 'åˆé¤ç¾é£Ÿèˆ‡ç”œé»å·¡ç¦®', location: 'éŠ€åº§å…«äº” / èŠ±å±±çƒé¾éºµéŠ€åº§åº—', details: 'ğŸœ ä¸»é¤ï¼šéŠ€åº§å…«äº” / èŠ±å±±çƒé¾éºµéŠ€åº§åº—ã€‚ç”œé»/ä¼´æ‰‹ç¦®ï¼šã‚·ãƒ…ã‚«æ´‹è“å­åº—ã€ç©ºä¹Ÿ/éŠ€åº§ç”˜æ¥½ (å’Œè“å­) æˆ– å¤é‡ (ç®¸)', tags: ['gourmet', 'shopping'] },
        { day: 5, time: '12:00', type: 'sight', title: 'éŠ€åº§ä¸‰è¶Š / GINZA SIX', location: 'éŠ€åº§ä¸‰è¶Š', details: 'ğŸ›ï¸ éŠ€åº§ä¸‰è¶Š B2 (FrÃ©dÃ©ric Cassel åƒå±¤é…¥ã€noix è²»å—é›ª) èˆ‡ GINZA SIX æ¢ç´¢', tags: ['shopping'] },
        { day: 5, time: '14:30', type: 'shopping', title: 'éŠ€åº§/æœ‰æ¨‚ç”ºè³¼ç‰©', location: 'MUJI éŠ€åº§æ——è‰¦åº—', details: 'ğŸ›’ MUJI ä¸–ç•Œæ——è‰¦åº—ã€LOFT åŠä¼Šæ±å±‹ (Itoya) æ–‡å…·åº—æ¢ç´¢', tags: ['shopping'] },        
        { day: 5, time: '18:30', type: 'gourmet', title: 'æ™šé¤ï¼šæ±äº¬è»Šç«™å‘¨é‚Šè‡ªç”±é¸æ“‡', location: 'æ±äº¬è»Šç«™', details: 'ğŸ½ï¸ è€ƒæ…®å±…é…’å±‹æˆ–ç‰¹è‰²æ–™ç†', tags: ['gourmet'] },
        { day: 5, time: '19:30', type: 'shopping', title: 'æ±äº¬ä¸€ç•ªè¡— / æ±äº¬è»Šç«™ / KITTE ä¸¸ä¹‹å…§', location: 'Sumikko Gurashi shop Tokyo Station', details: 'ğŸ›ï¸ Melindaè§’è½ç”Ÿç‰©ä»£è³¼ã€‚KITTEå¯ä¸Šé ‚æ¨“åº­åœ’çœ‹å¤œæ™¯ã€‚æ±äº¬è»Šç«™ï¼Œé«”é©—è–èª•ç‰¹åˆ¥æ´»å‹•ã€‚', tags: ['shopping', 'sight'] },
        { day: 5, time: '21:30', type: 'shopping', title: 'ãƒ‰ãƒ³ãƒ»ã‚­ãƒ›ãƒ¼ãƒ† æµ…è‰åº— (24hr)', location: 'ãƒ‰ãƒ³ãƒ»ã‚­ãƒ›ãƒ¼ãƒ† æµ…è‰åº—', details: 'ğŸ›’ æœ€å¾Œæ¡è³¼ã€‚ã¤ãã°EXæµ…è‰é§…å¾’æ­©1åˆ†ã€‚24Hç‡Ÿæ¥­ã€‚', tags: ['shopping'] },

        // Day 6: Ginkgo & Trend
        { day: 6, date: '2025/12/8 (Mon)', dayName: 'è¡¨åƒé“èˆ‡æ¾€è°·æ½®æµæ¢ç´¢ ğŸ‚', location: 'æ±äº¬', time: '08:40', type: 'gourmet', title: 'bricolage bread & co.', location: 'bricolage bread and co.å…­æœ¬æœ¨ ', details: 'ğŸ æ±äº¬å¿…åƒæ—©åˆé¤ååº— (æˆ–æ˜¯å»No.4)', tags: ['gourmet'] },
        { day: 6, time: '10:40', type: 'sight', title: 'æ˜æ²»ç¥å®®', location: 'æ˜æ²»ç¥å®®', details: 'â›©ï¸ åƒæ‹œä¸¦åœ¨å¯§éœæ£®æ—ä¸­æ¼«æ­¥', tags: ['sight'] },
        { day: 6, time: '12:00', type: 'gourmet', title: 'åˆé¤ï¼šåŸå®¿æˆ–è¡¨åƒé“é™„è¿‘è‡ªç”±é¸æ“‡', location: 'ã—ã‚ƒã¶ã—ã‚ƒã¶ å±±ç¬‘ãµ è¡¨å‚é“åº—', details: 'ğŸ¦ äººæ°£é¾è¦å ¡/å£½å–œç‡’/æ³•å¼è–„é¤…/ç”œç”œåœˆ/èŒ¶æ´’é‡‘ç”°ä¸­çš„è‰è“å¤§ç¦', tags: ['gourmet'] },
        { day: 6, time: '13:40', type: 'shopping', title: 'è¡¨åƒé“ / Onitsuka / NUMBER SUGAR / 3coins', location: 'æ‰‹å·¥ç‰›å¥¶ç³– NUMBER SUGAR / ã‚ªãƒ‹ãƒ„ã‚«ã‚¿ã‚¤ã‚¬ãƒ¼ è¡¨å‚é“', details: 'ğŸ›ï¸ æ½®æµèˆ‡è¨­è¨ˆå°ç‰©ã€‚é¬¼è™æ——è‰¦åº—ã€‚æ²æ¨‚æ„›åƒçš„ç‰›å¥¶ç³–å¿…è²·ã€‚', tags: ['shopping'] },
        { day: 6, time: '15:45', type: 'sight', title: 'Shibuya SKY', location: 'Shibuya SKY', details: 'ğŸŒ† å·²é è¨‚! 16:20-16:39 å…¥å ´ï¼Œæ¬£è³æ—¥è½', tags: ['sight', 'alert'] },
        { day: 6, time: '19:00', type: 'sight', title: 'æ™šé¤ï¼šæ¾€è°·æˆ–æ–°å®¿å‘¨é‚Šç¾é£Ÿ', location: 'eggslut Shinjuku Southern Terrace / AFURI æ¸‹è°·é“ç„å‚ ', details: 'ğŸœ è€ƒæ…® AFURI / eggslut', tags: ['gourmet'] },
        { day: 6, time: '20:00', type: 'shopping', title: 'æ–°å®¿è³¼ç‰©è¡åˆº', location: 'ãƒ“ãƒƒã‚¯ã‚«ãƒ¡ãƒ© æ–°å®¿æ±å£åº—', details: 'ğŸ›’ æ–°å®¿æ±å£ BicCamera / æ¾æœ¬æ¸…ï¼Œæ™šä¸Šç›¡æƒ…è³¼ç‰©', tags: ['shopping'] },

        // Day 7: Departure
        { day: 7, date: '2025/12/9 (Tue)', dayName: 'å‘Šåˆ¥æ±äº¬ ğŸ‘‹', location: 'æ±äº¬', time: '08:30', type: 'accommodation', title: 'è®Šãªãƒ›ãƒ†ãƒ«æ±äº¬æµ…è‰ç”°åŸç”º é€€æˆ¿', location: 'è®Šãªãƒ›ãƒ†ãƒ«æ±äº¬æµ…è‰ç”°åŸç”º', details: 'ğŸš¶ æ­¥è¡Œ 4 åˆ†é˜', tags: ['accommodation'] },
        { day: 7, time: '08:45', type: 'transport', title: 'äº¬æˆä¸Šé‡ç«™ æ‰‹è·ç‰©æ«ƒå°', location: 'äº¬æˆä¸Šé‡é§…æ‰‹è·ç‰©ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼', details: 'ğŸ’¼ å¯„æ”¾è¡Œæ (Â¥800)', tags: ['transport'] },
        { day: 7, time: '09:00', type: 'shopping', title: 'OS Drug / The Gardenè¶…å¸‚ / å°å³¶å±‹ / UNIQLO å¾¡å¾’ç”ºåº—', location: 'é˜¿ç¾æ©«ç”º', details: 'ğŸ æœ€å¾Œè£œè²¨', tags: ['shopping'] },
        { day: 7, time: '12:20', type: 'transport', title: 'äº¬æˆ Skyliner å¾€ æˆç”°ç©ºæ¸¯', location: 'æˆç”°åœ‹éš›æ©Ÿå ´', details: 'ğŸš„ äº¤é€šé è¨‚æé†’ï¼šæœªè¨‚ç¥¨ (Â¥2,567)', tags: ['transport', 'alert'], link: 'https://www.keisei.co.jp/keisei/tetudou/skyliner/tc/traffic/skyliner.php' }, // æ–°å¢ Skyliner é€£çµ
        { day: 7, time: '15:40', type: 'transport', title: 'æˆç”°ç©ºæ¸¯2èˆªå»ˆ (NRT)', location: 'æˆç”°åœ‹éš›æ©Ÿå ´', details: 'ğŸ›« èˆªç­ JX803', tags: ['transport'] },
        { day: 7, time: '18:45', type: 'transport', title: 'å°åŒ— (TPE)', location: 'æ¡ƒåœ’åœ‹éš›æ©Ÿå ´', details: 'ğŸ‡¹ğŸ‡¼ æ—…é€”æ„‰å¿«ï¼', tags: ['transport'] },
    ];

    // é¡å¤–å·¥å…·å€å¡Šçš„è³‡æ–™
    const toolData = {
        flight: [
            { label: 'å»ç¨‹', value: 'JX801 (11:30 TPE â†’ 14:20 NRT)' },
            { label: 'å›ç¨‹', value: 'JX803 (15:40 NRT â†’ 18:45 TPE)' },
            { label: 'èˆªç©ºå…¬å¸', value: 'æ˜Ÿå®‡èˆªç©º Starlux' },
        ],
        hotel: [
            { label: 'è¼•äº•æ¾¤ (12/3-12/5)', value: 'Hotel Cypress Karuizawa (02æ™š)' },
            { label: 'æ±äº¬ (12/5-12/9)', value: 'å¤‰ãªãƒ›ãƒ†ãƒ«æ±äº¬æµ…è‰ç”°åŸç”º (04æ™š)' },
        ],
        emergency: [
            { label: 'ç•¶åœ°å ±è­¦ (Police)', value: '110', class: 'text-2xl font-black text-red-700' },
            { label: 'ç•¶åœ°æ•‘è­·/æ¶ˆé˜² (Ambulance)', value: '119', class: 'text-2xl font-black text-red-700' },
            { label: 'è¨ªæ—¥å¤–åœ‹äººé†«ç™‚ & æ€¥é›£ç†±ç·š (JNTO)', value: '050-3816-2787', class: 'text-xl font-bold text-gray-800' },
            { label: 'å°ç£é§æ—¥ä»£è¡¨è™•', value: '+81-3-3280-7800 (è«‹å…ˆæ’¥æ‰“)', class: 'text-base font-medium text-blue-600' },
        ],
    };

    // æ¯æ—¥æ©«å¹…åœ–ç‰‡è³‡æ–™ (ä½¿ç”¨ç´”è‰²èƒŒæ™¯ä½”ä½ç¬¦ï¼Œæ–¹ä¾¿ä¹‹å¾Œæ›´æ›ç‚ºé¢¨æ™¯ç…§)
    const dayImageMap = {
        1: 'Gemini_Generated_Image_01.png', // Karuizawa Arrival
        2: 'Gemini_Generated_Image_01.png', // Winter Karuizawa
        3: 'Gemini_Generated_Image_01.png', // Tokyo Switch
        4: 'Gemini_Generated_Image_02.png', // Edo & Modern Night
        5: 'Gemini_Generated_Image_03.png', // Tsukiji & Ginza
        6: 'Gemini_Generated_Image_04.png', // Ginkgo & Trend
        7: 'https://placehold.co/800x200/3e3e3e/3e3e3e', // Departure
    };

    // --- Utility Functions ---

    /**
     * æ¨¡æ“¬å¾ä¼ºæœå™¨å–å¾—åœ°é»å¤©æ°£è³‡è¨Š
     * @param {string} location åœ°é»åç¨± (å¯¦éš›ä¸Šæ˜¯ dayName)
     * @param {string} date æ—¥æœŸ
     * @returns {object} æ¨¡æ“¬å¤©æ°£è³‡è¨Š
     */
    function mockWeather(location, date) {
        // ç¢ºä¿ location æ˜¯å­—ä¸²ï¼Œå¦‚æœå‚³å…¥ undefined å‰‡çµ¦ä¸€å€‹é è¨­å€¼ï¼Œé˜²æ­¢ .includes() å ±éŒ¯
        const safeLocation = String(location || 'æ±äº¬'); 

        const weatherMap = {
            'è¼•äº•æ¾¤': { temp: '2Â°C ~ 9Â°C', condition: 'â„ï¸ æ™´æ™‚å¤šé›² (å¯èƒ½é™é›ª)', wind: 'è¼•é¢¨', hourly: [{ time: '08:00', icon: 'â˜€ï¸', temp: '7Â°' }, { time: '11:00', icon: 'â˜ï¸', temp: '9Â°' }, { time: '14:00', icon: 'ğŸŒ¨ï¸', temp: '5Â°' }, { time: '17:00', icon: 'â„ï¸', temp: '2Â°' }] },
            'æ±äº¬': { temp: '6Â°C ~ 14Â°C', condition: 'â˜€ï¸ æ™´æœ—ï¼Œä¹¾ç‡¥', wind: 'å¾®é¢¨', hourly: [{ time: '08:00', icon: 'â˜€ï¸', temp: '8Â°' }, { time: '11:00', icon: 'ğŸŒ¤ï¸', temp: '12Â°' }, { time: '14:00', icon: 'ğŸŒ¤ï¸', temp: '14Â°' }, { time: '17:00', icon: 'â˜ï¸', temp: '10Â°' }] },
            'æˆç”°åœ‹éš›æ©Ÿå ´': { temp: '7Â°C ~ 15Â°C', condition: 'âœˆï¸ å¤šé›²ï¼Œå¶çˆ¾æ”¾æ™´', wind: 'å¼·é¢¨', hourly: [{ time: '08:00', icon: 'â˜ï¸', temp: '7Â°' }, { time: '11:00', icon: 'ğŸŒ¤ï¸', temp: '12Â°' }, { time: '14:00', icon: 'â˜€ï¸', temp: '15Â°' }, { time: '17:00', icon: 'âœˆï¸', temp: '13Â°' }] },
        };
        
        // ä½¿ç”¨ safeLocation é€²è¡Œåˆ¤æ–·
        let key = safeLocation.includes('è¼•äº•æ¾¤') ? 'è¼•äº•æ¾¤' : safeLocation.includes('æ±äº¬') || safeLocation.includes('æ·ºè‰') || safeLocation.includes('å…­æœ¬æœ¨') || safeLocation.includes('éŠ€åº§') || safeLocation.includes('åŸå®¿') || safeLocation.includes('æ·±å·') ? 'æ±äº¬' : 'æˆç”°åœ‹éš›æ©Ÿå ´';
        
        return weatherMap[key] || { temp: 'N/A', condition: 'æŸ¥è©¢ä¸­...', wind: 'N/A', hourly: [] };
    }

    // --- Renderer Functions ---

    /**
     * æ¸²æŸ“å–®ä¸€è¡Œç¨‹é …ç›®å¡ç‰‡ (æ™‚é–“è»¸æ¨£å¼)
     * @param {object} item å–®ä¸€è¡Œç¨‹è³‡æ–™
     * @returns {string} HTML å­—ä¸²
     */
    function renderItineraryItem(item) {
        const typeClasses = {
            'sight': 'tag-sight',
            'gourmet': 'tag-gourmet',
            'transport': 'tag-transport',
            'accommodation': 'tag-accommodation',
            'shopping': 'tag-sight', 
        };
        const typeClassName = typeClasses[item.type] || 'tag-base';
        const isAlert = item.tags.includes('alert');
        const alertClass = isAlert ? 'timeline-alert' : '';

        // æª¢æŸ¥æ˜¯å¦æœ‰åœ°é»è³‡è¨Šï¼Œè‹¥æœ‰å‰‡é¡¯ç¤ºåœ°åœ–æŒ‰éˆ• (éäº¤é€šé¡)
        const mapButton = item.location && item.type !== 'transport' ? 
            `<button onclick="handleMapClick('${item.location}')" class="flex items-center text-blue-600 text-sm font-medium hover:text-blue-800 transition">
                <i data-lucide="map-pin" class="w-4 h-4 mr-1"></i> åœ°åœ–
            </button>` : '';

        // æª¢æŸ¥æ˜¯å¦æœ‰å¤–éƒ¨é€£çµ (å¦‚ Skyliner æ™‚åˆ»è¡¨)
        const linkButton = item.link ? 
            `<a href="${item.link}" target="_blank" class="flex items-center text-red-600 text-sm font-medium hover:text-red-800 transition ${mapButton ? 'ml-3' : ''}">
                <i data-lucide="route" class="w-4 h-4 mr-1"></i> è·¯ç·š/æ™‚åˆ»è¡¨
            </a>` : '';
        
        return `
            <div id="item-${item.day}-${item.time.replace(':', '')}" class="timeline-item ${alertClass}">
                <div class="timeline-dot"></div>
                
                <div class="flex items-start justify-between">
                    <div class="flex flex-col flex-grow">
                        <span class="text-sm font-light text-gray-400">${item.time}</span>
                        <h4 class="text-base font-bold text-gray-800 mt-0.5">${item.title}</h4>
                    </div>
                    <!-- å®¹ç´ åœ°åœ–/è·¯ç·šæ™‚åˆ»è¡¨ çš„æŒ‰éˆ•å®¹å™¨ -->
                    <div class="flex items-center flex-shrink-0">
                        ${mapButton}
                        ${linkButton}
                    </div>
                </div>
                
                <p class="text-sm text-gray-700 mt-1">${item.details}</p>
                <span class="${typeClassName} tag-base mt-2 inline-block">${item.type === 'shopping' ? 'è³¼ç‰©' : item.type === 'gourmet' ? 'ç¾é£Ÿ' : item.type === 'transport' ? 'äº¤é€š' : 'æ™¯é»'}</span>
            </div>
        `;
    }
    
    /**
     * æ¸²æŸ“å–®æ—¥è¡Œç¨‹å€å¡Š (åŒ…å«å¤©æ°£èˆ‡æ©«å¹…)
     * @param {number} dayNumber å¤©æ•¸
     * @param {string} date æ—¥æœŸ
     * @param {string} dayName ç•¶æ—¥æ¨™é¡Œ
     * @param {Array<object>} items ç•¶æ—¥è¡Œç¨‹é …ç›®
     * @returns {string} HTML å­—ä¸²
     */
    function renderDailyItinerary(dayNumber, date, dayName, items) {
        const weather = mockWeather(dayName, date);
        // ä½¿ç”¨ dayName åˆ¤æ–·åœ°é»
        const location = String(dayName).includes('è¼•äº•æ¾¤') ? 'è¼•äº•æ¾¤' : 'æ±äº¬';

        // æ¨¡æ“¬æ©«å¹…åœ–ç‰‡ (ä½¿ç”¨ç´”è‰²ä½”ä½ç¬¦)
        const bannerUrl = dayImageMap[dayNumber] || dayImageMap[3]; 

        const hourlyHtml = weather.hourly.map(h => `
            <div class="flex flex-col items-center text-xs text-gray-600">
                <span class="font-medium">${h.time}</span>
                <span class="text-xl my-1">${h.icon}</span>
                <span class="font-bold">${h.temp}</span>
            </div>
        `).join('');

        const itineraryItemsHtml = items.map(renderItineraryItem).join('');

        return `
            <section id="day-${dayNumber}-section" data-day="${dayNumber}" class="daily-section hidden mb-8">
                
                <!-- Day Banner -->
                <div class="h-48 rounded-xl overflow-hidden mb-6 relative card-shadow">
                    <!-- ä½¿ç”¨ç´”è‰²èƒŒæ™¯ä½”ä½ç¬¦ï¼Œæ–¹ä¾¿ä¹‹å¾Œæ›¿æ›ç‚ºé¢¨æ™¯ç…§ -->
                    <img src="${bannerUrl}" 
                         onerror="this.onerror=null;this.src='https://placehold.co/800x200/5a6797/5a6797';" 
                         alt="${dayName}" 
                         class="w-full h-full object-cover">
                    <!-- ç–ŠåŠ çš„æ–‡å­—è³‡è¨Š -->
                    <div class="absolute inset-0 bg-black bg-opacity-30 flex flex-col justify-end p-5 text-white">
                        <p class="text-sm font-medium">DAY ${dayNumber}</p>
                        <h3 class="text-2xl font-black mt-1">${dayName.split(' ')[0]}</h3>
                        <p class="text-xs font-light mt-1">${date}</p>
                    </div>
                </div>

                <!-- Weather Card -->
                <div class="bg-white p-5 rounded-xl mb-6 card-shadow">
                    <div class="flex justify-between items-center text-sm font-medium text-gray-600 border-b pb-2 mb-3">
                        <span class="flex items-center">
                            <i data-lucide="cloud-sun" class="w-5 h-5 mr-1 text-blue-500"></i> 
                            ${location} å³æ™‚å¤©æ°£
                        </span>
                        <span class="text-xs text-gray-400">æœªä¾† 24 å°æ™‚é å ±</span>
                    </div>
                    <div class="flex justify-around space-x-2">
                        ${hourlyHtml}
                    </div>
                </div>

                <!-- Itinerary Items (Timeline Container) -->
                <div class="timeline-container">
                    ${itineraryItemsHtml}
                </div>
            </section>
        `;
    }

    /**
     * æ¸²æŸ“ä¸»è¡Œç¨‹åˆ—è¡¨å’Œå°èˆªæŒ‰éˆ•
     */
    function renderItinerary() {
        const listContainer = document.getElementById('itinerary-list');
        const navContainer = document.getElementById('day-nav-pills');
        listContainer.innerHTML = '';
        navContainer.innerHTML = '';

        let html = '';

        // åˆ†çµ„ä¸¦æ¸²æŸ“æ¯æ—¥è¡Œç¨‹
        const groupedData = itineraryData.reduce((acc, item) => {
            if (!acc[item.day]) {
                acc[item.day] = [];
            }
            acc[item.day].push(item);
            return acc;
        }, {});

        Object.keys(groupedData).forEach(day => {
            const dayNumber = parseInt(day);
            const dayItems = groupedData[dayNumber];
            const dayItem = dayItems[0];
            // ç”±æ–¼å·²ç¢ºä¿ dayItem å­˜åœ¨ä¸”å«æœ‰ date/dayNameï¼Œé€™è£¡å¯ä»¥ç›´æ¥å‚³é
            html += renderDailyItinerary(dayNumber, dayItem.date, dayItem.dayName, dayItems);
        });

        listContainer.innerHTML = html;

        // æ¸²æŸ“ Nav Pills (æ˜ŸæœŸå¹¾/æ—…éŠå¤©æ•¸ æ ¼å¼)
        Object.keys(groupedData).forEach(day => {
            const dayNumber = parseInt(day);
            const dayItem = groupedData[dayNumber][0];
            // æå– DayOfWeek
            const dayOfWeek = dayItem.date.includes('(Wed)') ? 'ä¸‰' : dayItem.date.includes('(Thu)') ? 'å››' : dayItem.date.includes('(Fri)') ? 'äº”' : dayItem.date.includes('(Sat)') ? 'å…­' : dayItem.date.includes('(Sun)') ? 'æ—¥' : dayItem.date.includes('(Mon)') ? 'ä¸€' : 'äºŒ';

            // *** æ ¸å¿ƒä¿®æ”¹ï¼šå°‡é¡¯ç¤ºçš„æ—¥æœŸæ”¹ç‚ºæ—…éŠå¤©æ•¸ ***
            const displayDay = `Day ${dayNumber}`; 

            navContainer.innerHTML += `
                <button onclick="showDay(${dayNumber})" 
                        class="day-pill flex-shrink-0 text-center transition duration-150 p-2 rounded-xl text-xs font-medium w-14 h-16 border border-gray-200 bg-white hover:bg-gray-50 
                        data-[active='true']:bg-gray-800 data-[active='true']:text-white data-[active='true']:shadow-lg" 
                        data-day="${dayNumber}">
                    <span class="text-xs font-semibold block mb-0.5">${dayOfWeek}</span>
                    <span class="block text-base font-black">${displayDay}</span> <!-- å­—é«”å¤§å°æ”¹ç‚º text-base ä»¥å®¹ç´ Day X -->
                </button>
            `;
        });
    }

    /**
     * æ¸²æŸ“å·¥å…·å€å¡Šçš„éœæ…‹è³‡æ–™
     */
    function renderTools() {
        // Flight Info
        const flightHtml = toolData.flight.map(d => 
            `<div class="flex justify-between border-b border-dashed py-1 last:border-b-0">
                <span class="text-gray-500">${d.label}:</span>
                <span class="text-gray-800 font-medium">${d.value}</span>
            </div>`
        ).join('');
        document.getElementById('flight-info').innerHTML = flightHtml;

        // Accommodation Info
        const hotelHtml = toolData.hotel.map(d => 
            `<div class="flex justify-between border-b border-dashed py-1 last:border-b-0">
                <span class="text-gray-500">${d.label}:</span>
                <span class="text-gray-800 font-medium">${d.value}</span>
            </div>`
        ).join('');
        document.getElementById('hotel-info').innerHTML = hotelHtml;

        // Emergency Info
        const emergencyHtml = `
            <div class="grid grid-cols-2 gap-4 mb-4">
                <div class="text-center p-3 bg-red-50 rounded-lg border border-red-200">
                    <p class="text-xs font-semibold text-gray-500">è­¦å¯Ÿ (POLICE)</p>
                    <p class="text-3xl font-black text-red-700 mt-1">${toolData.emergency.find(d => d.label === 'ç•¶åœ°å ±è­¦ (Police)').value}</p>
                </div>
                <div class="text-center p-3 bg-red-50 rounded-lg border border-red-200">
                    <p class="text-xs font-semibold text-gray-500">æ•‘è­·/æ¶ˆé˜² (Ambulance)</p>
                    <p class="text-3xl font-black text-red-700 mt-1">${toolData.emergency.find(d => d.label === 'ç•¶åœ°æ•‘è­·/æ¶ˆé˜² (Ambulance)').value}</p>
                </div>
            </div>
            <div class="p-3 bg-gray-50 rounded-lg border border-gray-200">
                <p class="text-xs font-semibold text-gray-500">è¨ªæ—¥å¤–åœ‹äººé†«ç™‚ & æ€¥é›£ç†±ç·š (JNTO)</p>
                <p class="text-xl font-bold text-gray-800 mt-1">${toolData.emergency.find(d => d.label === 'è¨ªæ—¥å¤–åœ‹äººé†«ç™‚ & æ€¥é›£ç†±ç·š (JNTO)').value}</p>
                <p class="text-xs text-gray-400 mt-1">24å°æ™‚å°æ‡‰ (è‹±/ä¸­/éŸ“)ã€‚ç”Ÿç—…å—å‚·æˆ–ç™¼ç”Ÿäº‹æ•…æ™‚å¯æ’¥æ‰“ã€‚</p>
            </div>
            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg border border-gray-200">
                <span class="text-xs font-semibold text-gray-500">å°ç£é§æ—¥ä»£è¡¨è™•</span>
                <span class="text-base font-medium text-blue-600">${toolData.emergency.find(d => d.label === 'å°ç£é§æ—¥ä»£è¡¨è™•').value}</span>
            </div>
        `;
        document.getElementById('emergency-info').innerHTML = emergencyHtml;
    }


    // --- Interaction Functions ---

    /**
     * åˆ‡æ›ä¸»æ¨™ç±¤
     * @param {string} tabName è¦é¡¯ç¤ºçš„æ¨™ç±¤åç¨± ('itinerary' æˆ– 'tools')
     */
    function showTab(tabName) {
        document.querySelectorAll('.tab-content').forEach(tab => {
            tab.classList.add('hidden');
            tab.classList.remove('active');
        });
        document.getElementById(`tab-${tabName}`).classList.remove('hidden');
        document.getElementById(`tab-${tabName}`).classList.add('active');

        document.querySelectorAll('.nav-btn').forEach(btn => {
            if (btn.getAttribute('data-tab') === tabName) {
                btn.classList.add('active-nav-btn', 'text-gray-800');
                btn.classList.remove('text-gray-500');
                btn.querySelector('span').classList.add('font-semibold');
            } else {
                btn.classList.remove('active-nav-btn', 'text-gray-800');
                btn.classList.add('text-gray-500');
                btn.querySelector('span').classList.remove('font-semibold');
            }
        });

        // å¦‚æœåˆ‡æ›å›è¡Œç¨‹ï¼Œç¢ºä¿é¡¯ç¤ºç•¶å‰å¤©æ•¸
        if (tabName === 'itinerary') {
            const activeDay = document.querySelector('.day-pill[data-active="true"]')?.getAttribute('data-day') || 1;
            showDay(parseInt(activeDay));
        }
    }

    /**
     * é¡¯ç¤ºå–®æ—¥è¡Œç¨‹
     * @param {number} dayNumber è¦é¡¯ç¤ºçš„å¤©æ•¸
     */
    function showDay(dayNumber) {
        document.querySelectorAll('.daily-section').forEach(section => {
            section.classList.add('hidden');
        });
        document.getElementById(`day-${dayNumber}-section`).classList.remove('hidden');

        // æ›´æ–°å°èˆªæŒ‰éˆ•ç‹€æ…‹
        document.querySelectorAll('.day-pill').forEach(pill => {
            const isActive = parseInt(pill.getAttribute('data-day')) === dayNumber;
            pill.setAttribute('data-active', isActive);
            if (isActive) {
                // æ»¾å‹•åˆ°ç•¶å‰æ¿€æ´»æŒ‰éˆ•
                pill.scrollIntoView({ behavior: 'smooth', inline: 'center' });
            }
        });
    }

    /**
     * è™•ç†åœ°åœ–æŒ‰éˆ•é»æ“Šäº‹ä»¶
     * @param {string} location åœ°é»åç¨±
     */
    function handleMapClick(location) {
        // ä½¿ç”¨ Google Maps æŸ¥è©¢åœ°é»åç¨±
        const mapUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(location + ', æ—¥æœ¬')}`;
        window.open(mapUrl, '_blank');
    }


    // --- Initialization ---

    document.addEventListener('DOMContentLoaded', () => {
        // 1. æ¸²æŸ“æ‰€æœ‰è³‡æ–™
        renderItinerary();
        renderTools();
        
        // 2. åˆå§‹åŒ–åœ–æ¨™
        // æ–°å¢ route åœ–æ¨™
        lucide.createIcons({ icons: { route: lucide.icons.route } }); 
        lucide.createIcons();

        // 3. é è¨­é¡¯ç¤º Day 1 (è¼•äº•æ¾¤åˆè¦‹) 
        showDay(1);

        // 4. è¨­å®šåº•éƒ¨å°èˆªäº‹ä»¶
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                showTab(e.currentTarget.getAttribute('data-tab'));
            });
        });
        
        // 5. é è¨­é¡¯ç¤ºè¡Œç¨‹é é¢
        showTab('itinerary');
    });

</script>

</body>
</html>





















































